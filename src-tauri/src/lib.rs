pub mod bootstrap;
pub mod commands;
pub mod connectivity;

use crate::commands::state::AppStateContainer;

#[cfg_attr(mobile, tauri::mobile_entry_point)]
pub async fn run() {
    tauri::Builder::default()
        .manage(AppStateContainer::default())
        .plugin(tauri_plugin_opener::init())
        .plugin(tauri_plugin_notification::init())
        .invoke_handler(tauri::generate_handler![
            commands::identity::get_peer_id,
            commands::identity::get_public_key,
            commands::identity::generate_identity,
            commands::messages::send_message,
            commands::messages::send_message_with_attachments,
            commands::messages::send_direct_message,
            commands::messages::send_direct_message_with_attachments,
            commands::messages::encrypt_chat_payload,
            commands::messages::decrypt_chat_payload,
            commands::messages::delete_message,
            commands::messages::pin_message,
            commands::messages::unpin_message,
            commands::messages::add_reaction,
            commands::messages::remove_reaction,
            commands::messages::send_encrypted_dm,
            commands::messages::send_read_receipt,
            commands::messages::send_typing_indicator,
            commands::messages::rotate_group_key,
            commands::messages::send_encrypted_group_message,
            commands::chats::create_group_dm,
            commands::chats::leave_group_dm,
            commands::chats::get_group_chats,
            commands::presence::send_presence_update,
            commands::presence::mark_self_presence_local,
            commands::users::update_user_profile,
            commands::users::get_user,
            commands::friends::send_friend_request,
            commands::friends::accept_friend_request,
            commands::friends::block_user,
            commands::friends::unblock_user,
            commands::friends::remove_friendship,
            commands::friends::get_friendships_for_user,
            commands::servers::create_server,
            commands::servers::join_server,
            commands::servers::redeem_server_invite,
            commands::servers::leave_server,
            commands::servers::remove_server_member,
            commands::servers::unban_server_member,
            commands::servers::create_channel,
            commands::servers::create_channel_category,
            commands::servers::delete_channel_category,
            commands::friends::get_friendships,
            commands::servers::get_servers,
            commands::messages::get_messages,
            commands::messages::get_attachment_bytes,
            commands::messages::resolve_link_preview,
            commands::servers::get_channels_for_server,
            commands::servers::get_channel_categories_for_server,
            commands::servers::get_members_for_server,
            commands::servers::list_server_bans,
            commands::servers::send_server_invite,
            commands::servers::generate_server_invite,
            commands::servers::list_server_invites,
            commands::servers::revoke_server_invite,
            commands::servers::get_channel_display_preferences,
            commands::servers::set_channel_display_preferences,
            commands::servers::delete_channel,
            commands::servers::delete_server,
            commands::servers::update_server_metadata,
            commands::servers::update_server_roles,
            commands::servers::update_server_channels,
            commands::servers::update_server_moderation_flags,
            commands::servers::get_server_details,
            commands::servers::list_server_events,
            commands::servers::create_server_event,
            commands::servers::update_server_event,
            commands::servers::cancel_server_event,
            commands::servers::list_server_webhooks,
            commands::servers::create_server_webhook,
            commands::servers::update_server_webhook,
            commands::servers::delete_server_webhook,
            commands::reviews::list_user_reviews,
            commands::reviews::list_server_reviews,
            commands::reviews::submit_review,
            commands::identity::unlock_identity,
            commands::identity::is_identity_created,
            commands::identity::initialize_app,
            commands::identity::rekey_identity,
            commands::identity::reset_identity,
            commands::files::send_file,
            commands::files::approve_file_transfer,
            commands::files::reject_file_transfer,
            commands::calls::send_call_signal,
            commands::settings::get_file_acl_policy,
            commands::settings::set_file_acl_policy,
            commands::settings::set_voice_memos_enabled,
            commands::data_privacy::export_user_data,
            commands::data_privacy::request_account_deletion,
            commands::data_privacy::panic_wipe,
            commands::connected_accounts::list_connected_accounts,
            commands::connected_accounts::link_external_account,
            commands::connected_accounts::unlink_external_account,
            commands::moderation::submit_user_report,
            commands::connectivity::get_connectivity_snapshot,
            commands::connectivity::set_bridge_mode_enabled,
            commands::connectivity::set_bluetooth_enabled,
            commands::connectivity::set_wifi_direct_enabled,
            commands::connectivity::set_routing_config,
            commands::collaboration::send_collaboration_update,
        ])
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
